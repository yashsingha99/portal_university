(self.webpackChunkstrapi_backend=self.webpackChunkstrapi_backend||[]).push([[1762],{87826:(w,y)=>{"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.default=i;function i(e,o){if(e==null)throw new TypeError("assign requires that input parameter not be null or undefined");for(var b in o)Object.prototype.hasOwnProperty.call(o,b)&&(e[b]=o[b]);return e}w.exports=y.default},21871:(w,y,i)=>{"use strict";var e=i(90448).default;Object.defineProperty(y,"__esModule",{value:!0}),y.default=b;var o=e(i(87826));function b(q){return(0,o.default)({},q)}w.exports=y.default},18724:(w,y)=>{"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.default=i;function i(e){var o=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return o.setUTCFullYear(e.getFullYear()),e.getTime()-o.getTime()}w.exports=y.default},34316:(w,y)=>{"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.default=i;function i(e){if(e===null||e===!0||e===!1)return NaN;var o=Number(e);return isNaN(o)?o:o<0?Math.ceil(o):Math.floor(o)}w.exports=y.default},90448:w=>{function y(i){return i&&i.__esModule?i:{default:i}}w.exports=y,w.exports.__esModule=!0,w.exports.default=w.exports},11762:(w,y,i)=>{"use strict";i.d(y,{App:()=>Qt});var e=i(92132),o=i(55506),b=i(17703),q=i(71389),g=i(52389),B=i(21272),ge=i(40427),$e=i(61485),Oe=i(99248),D=i(30893),Pe=i(6239),j=i(83997),Be=i(7537),J=i(94061),Ue=i(4181),He=i(49451),We=i(69533),Fe=i(67030),Q=i(85963),Ze=i(76517),Ge=i(80782),Xe=i(53563),Qe=i(90151),Ke=i(68074),_=i(10573),Je=i(20636),V=i(38413),he=i(55356),G=i(4198),Ve=i(12081),ee=i(12408),ke=i(48653),te=i(24093),ae=i(58805),qe=i(79739),_e=i(64871),et=i(88353),fe=i(48323),tt=i(90361),X=i(33363),me=i(21610),k=i(76132),at=i(49654),st=i(36481),nt=i(5194),rt=i(41909),lt=i(50612),it=i(49310),pe=i(85166),ot=i(46270),dt=i(85641),xe=i(6103),ct=i(21871),ut=i(34316),ve=i(18724);function gt(t,a){var s=pt(a);return s.formatToParts?ft(s,t):mt(s,t)}var ht={year:0,month:1,day:2,hour:3,minute:4,second:5};function ft(t,a){try{for(var s=t.formatToParts(a),n=[],r=0;r<s.length;r++){var l=ht[s[r].type];l>=0&&(n[l]=parseInt(s[r].value,10))}return n}catch(d){if(d instanceof RangeError)return[NaN];throw d}}function mt(t,a){var s=t.format(a).replace(/\u200E/g,""),n=/(\d+)\/(\d+)\/(\d+),? (\d+):(\d+):(\d+)/.exec(s);return[n[3],n[1],n[2],n[4],n[5],n[6]]}var se={};function pt(t){if(!se[t]){var a=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:"America/New_York",year:"numeric",month:"numeric",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}).format(new Date("2014-06-25T04:00:00.123Z")),s=a==="06/25/2014, 00:00:00"||a==="\u200E06\u200E/\u200E25\u200E/\u200E2014\u200E \u200E00\u200E:\u200E00\u200E:\u200E00";se[t]=s?new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:t,year:"numeric",month:"numeric",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}):new Intl.DateTimeFormat("en-US",{hourCycle:"h23",timeZone:t,year:"numeric",month:"numeric",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})}return se[t]}function ne(t,a,s,n,r,l,d){var u=new Date(0);return u.setUTCFullYear(t,a,s),u.setUTCHours(n,r,l,d),u}var je=36e5,xt=6e4,re={timezone:/([Z+-].*)$/,timezoneZ:/^(Z)$/,timezoneHH:/^([+-]\d{2})$/,timezoneHHMM:/^([+-]\d{2}):?(\d{2})$/};function le(t,a,s){var n,r;if(!t||(n=re.timezoneZ.exec(t),n))return 0;var l;if(n=re.timezoneHH.exec(t),n)return l=parseInt(n[1],10),ye(l)?-(l*je):NaN;if(n=re.timezoneHHMM.exec(t),n){l=parseInt(n[1],10);var d=parseInt(n[2],10);return ye(l,d)?(r=Math.abs(l)*je+d*xt,l>0?-r:r):NaN}if(yt(t)){a=new Date(a||Date.now());var u=s?a:vt(a),f=ie(u,t),p=s?f:jt(a,f,t);return-p}return NaN}function vt(t){return ne(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds())}function ie(t,a){var s=gt(t,a),n=ne(s[0],s[1]-1,s[2],s[3]%24,s[4],s[5],0).getTime(),r=t.getTime(),l=r%1e3;return r-=l>=0?l:1e3+l,n-r}function jt(t,a,s){var n=t.getTime(),r=n-a,l=ie(new Date(r),s);if(a===l)return a;r-=l-a;var d=ie(new Date(r),s);return l===d?l:Math.max(l,d)}function ye(t,a){return-23<=t&&t<=23&&(a==null||0<=a&&a<=59)}var De={};function yt(t){if(De[t])return!0;try{return new Intl.DateTimeFormat(void 0,{timeZone:t}),De[t]=!0,!0}catch{return!1}}var Dt=/(Z|[+-]\d{2}(?::?\d{2})?| UTC| [a-zA-Z]+\/[a-zA-Z_]+(?:\/[a-zA-Z_]+)?)$/;const Me=Dt;var oe=36e5,be=6e4,Mt=2,N={dateTimePattern:/^([0-9W+-]+)(T| )(.*)/,datePattern:/^([0-9W+-]+)(.*)/,plainTime:/:/,YY:/^(\d{2})$/,YYY:[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],YYYY:/^(\d{4})/,YYYYY:[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],MM:/^-(\d{2})$/,DDD:/^-?(\d{3})$/,MMDD:/^-?(\d{2})-?(\d{2})$/,Www:/^-?W(\d{2})$/,WwwD:/^-?W(\d{2})-?(\d{1})$/,HH:/^(\d{2}([.,]\d*)?)$/,HHMM:/^(\d{2}):?(\d{2}([.,]\d*)?)$/,HHMMSS:/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,timeZone:Me};function de(t,a){if(arguments.length<1)throw new TypeError("1 argument required, but only "+arguments.length+" present");if(t===null)return new Date(NaN);var s=a||{},n=s.additionalDigits==null?Mt:ut(s.additionalDigits);if(n!==2&&n!==1&&n!==0)throw new RangeError("additionalDigits must be 0, 1 or 2");if(t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]")return new Date(t.getTime());if(typeof t=="number"||Object.prototype.toString.call(t)==="[object Number]")return new Date(t);if(!(typeof t=="string"||Object.prototype.toString.call(t)==="[object String]"))return new Date(NaN);var r=bt(t),l=Tt(r.date,n),d=l.year,u=l.restDateString,f=Ct(u,d);if(isNaN(f))return new Date(NaN);if(f){var p=f.getTime(),I=0,c;if(r.time&&(I=It(r.time),isNaN(I)))return new Date(NaN);if(r.timeZone||s.timeZone){if(c=le(r.timeZone||s.timeZone,new Date(p+I)),isNaN(c))return new Date(NaN)}else c=ve(new Date(p+I)),c=ve(new Date(p+I+c));return new Date(p+I+c)}else return new Date(NaN)}function bt(t){var a={},s=N.dateTimePattern.exec(t),n;if(s?(a.date=s[1],n=s[3]):(s=N.datePattern.exec(t),s?(a.date=s[1],n=s[2]):(a.date=null,n=t)),n){var r=N.timeZone.exec(n);r?(a.time=n.replace(r[1],""),a.timeZone=r[1].trim()):a.time=n}return a}function Tt(t,a){var s=N.YYY[a],n=N.YYYYY[a],r;if(r=N.YYYY.exec(t)||n.exec(t),r){var l=r[1];return{year:parseInt(l,10),restDateString:t.slice(l.length)}}if(r=N.YY.exec(t)||s.exec(t),r){var d=r[1];return{year:parseInt(d,10)*100,restDateString:t.slice(d.length)}}return{year:null}}function Ct(t,a){if(a===null)return null;var s,n,r,l;if(t.length===0)return n=new Date(0),n.setUTCFullYear(a),n;if(s=N.MM.exec(t),s)return n=new Date(0),r=parseInt(s[1],10)-1,Ie(a,r)?(n.setUTCFullYear(a,r),n):new Date(NaN);if(s=N.DDD.exec(t),s){n=new Date(0);var d=parseInt(s[1],10);return Nt(a,d)?(n.setUTCFullYear(a,0,d),n):new Date(NaN)}if(s=N.MMDD.exec(t),s){n=new Date(0),r=parseInt(s[1],10)-1;var u=parseInt(s[2],10);return Ie(a,r,u)?(n.setUTCFullYear(a,r,u),n):new Date(NaN)}if(s=N.Www.exec(t),s)return l=parseInt(s[1],10)-1,Ae(a,l)?Te(a,l):new Date(NaN);if(s=N.WwwD.exec(t),s){l=parseInt(s[1],10)-1;var f=parseInt(s[2],10)-1;return Ae(a,l,f)?Te(a,l,f):new Date(NaN)}return null}function It(t){var a,s,n;if(a=N.HH.exec(t),a)return s=parseFloat(a[1].replace(",",".")),ce(s)?s%24*oe:NaN;if(a=N.HHMM.exec(t),a)return s=parseInt(a[1],10),n=parseFloat(a[2].replace(",",".")),ce(s,n)?s%24*oe+n*be:NaN;if(a=N.HHMMSS.exec(t),a){s=parseInt(a[1],10),n=parseInt(a[2],10);var r=parseFloat(a[3].replace(",","."));return ce(s,n,r)?s%24*oe+n*be+r*1e3:NaN}return null}function Te(t,a,s){a=a||0,s=s||0;var n=new Date(0);n.setUTCFullYear(t,0,4);var r=n.getUTCDay()||7,l=a*7+s+1-r;return n.setUTCDate(n.getUTCDate()+l),n}var At=[31,28,31,30,31,30,31,31,30,31,30,31],Rt=[31,29,31,30,31,30,31,31,30,31,30,31];function Ce(t){return t%400===0||t%4===0&&t%100!==0}function Ie(t,a,s){if(a<0||a>11)return!1;if(s!=null){if(s<1)return!1;var n=Ce(t);if(n&&s>Rt[a]||!n&&s>At[a])return!1}return!0}function Nt(t,a){if(a<1)return!1;var s=Ce(t);return!(s&&a>366||!s&&a>365)}function Ae(t,a,s){return!(a<0||a>52||s!=null&&(s<0||s>6))}function ce(t,a,s){return!(t!=null&&(t<0||t>=25)||a!=null&&(a<0||a>=60)||s!=null&&(s<0||s>=60))}function St(t,a,s){if(typeof t=="string"&&!t.match(Me)){var n=ct(s);return n.timeZone=a,de(t,n)}var r=de(t,s),l=ne(r.getFullYear(),r.getMonth(),r.getDate(),r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds()).getTime(),d=le(a,new Date(l));return new Date(l+d)}function Re(t,a,s){var n=de(t,s),r=le(a,n,!0),l=new Date(n.getTime()-r),d=new Date(0);return d.setFullYear(l.getUTCFullYear(),l.getUTCMonth(),l.getUTCDate()),d.setHours(l.getUTCHours(),l.getUTCMinutes(),l.getUTCSeconds(),l.getUTCMilliseconds()),d}var U=i(54894),H=i(63891),zt=i(50958),ue=i(61535),E=i(12083),Kt=i(82437);const wt=E.Ik().shape({name:E.Yj().trim().required(),scheduledAt:E.Yj().nullable(),isScheduled:E.zM().optional(),time:E.Yj().when("isScheduled",{is:!0,then:E.Yj().trim().required(),otherwise:E.Yj().nullable()}),timezone:E.Yj().when("isScheduled",{is:!0,then:E.Yj().required().nullable(),otherwise:E.Yj().nullable()}),date:E.Yj().when("isScheduled",{is:!0,then:E.Yj().required().nullable(),otherwise:E.Yj().nullable()})}).required().noUnknown(),Ne=({handleClose:t,handleSubmit:a,initialValues:s,isLoading:n=!1})=>{const{formatMessage:r}=(0,U.A)(),{pathname:l}=(0,b.zy)(),d=l===`/plugins/${g.p}`,{timezoneList:u,systemTimezone:f={value:"UTC+00:00-Africa/Abidjan "}}=Se(s.scheduledAt?new Date(s.scheduledAt):new Date),p=c=>{const{date:A,time:S,timezone:x}=c;if(!A||!S||!x)return null;const T=x.split("&")[1];return St(`${A} ${S}`,T)},I=()=>u.find(A=>A.value.split("&")[1]===s.timezone)?.value||f.value;return(0,e.jsxs)($e.k,{onClose:t,labelledBy:"title",children:[(0,e.jsx)(Oe.r,{children:(0,e.jsx)(D.o,{id:"title",fontWeight:"bold",textColor:"neutral800",children:r({id:"content-releases.modal.title",defaultMessage:"{isCreatingRelease, select, true {New release} other {Edit release}}"},{isCreatingRelease:d})})}),(0,e.jsx)(ue.l1,{onSubmit:c=>{a({...c,timezone:c.timezone?c.timezone.split("&")[1]:null,scheduledAt:c.isScheduled?p(c):null})},initialValues:{...s,timezone:s.timezone?I():f.value},validationSchema:wt,validateOnChange:!1,children:({values:c,errors:A,handleChange:S,setFieldValue:x})=>(0,e.jsxs)(ue.lV,{children:[(0,e.jsx)(Pe.c,{children:(0,e.jsxs)(j.s,{direction:"column",alignItems:"stretch",gap:6,children:[(0,e.jsx)(Be.k,{label:r({id:"content-releases.modal.form.input.label.release-name",defaultMessage:"Name"}),name:"name",value:c.name,error:A.name,onChange:S,required:!0}),(0,e.jsx)(J.a,{width:"max-content",children:(0,e.jsx)(Ue.S,{name:"isScheduled",value:c.isScheduled,onChange:T=>{x("isScheduled",T.target.checked),T.target.checked?(x("date",s.date),x("time",s.time),x("timezone",s.timezone??f?.value)):(x("date",null),x("time",""),x("timezone",null))},children:(0,e.jsx)(D.o,{textColor:c.isScheduled?"primary600":"neutral800",fontWeight:c.isScheduled?"semiBold":"regular",children:r({id:"modal.form.input.label.schedule-release",defaultMessage:"Schedule release"})})})}),c.isScheduled&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(j.s,{gap:4,alignItems:"start",children:[(0,e.jsx)(J.a,{width:"100%",children:(0,e.jsx)(He.l,{label:r({id:"content-releases.modal.form.input.label.date",defaultMessage:"Date"}),name:"date",error:A.date,onChange:T=>{const Y=T?(0,zt.A)(T,{representation:"date"}):null;x("date",Y)},clearLabel:r({id:"content-releases.modal.form.input.clearLabel",defaultMessage:"Clear"}),onClear:()=>{x("date",null)},selectedDate:c.date||void 0,required:!0,minDate:Re(new Date,c.timezone.split("&")[1])})}),(0,e.jsx)(J.a,{width:"100%",children:(0,e.jsx)(We.A,{label:r({id:"content-releases.modal.form.input.label.time",defaultMessage:"Time"}),name:"time",error:A.time,onChange:T=>{x("time",T)},clearLabel:r({id:"content-releases.modal.form.input.clearLabel",defaultMessage:"Clear"}),onClear:()=>{x("time","")},value:c.time||void 0,required:!0})})]}),(0,e.jsx)(Et,{timezoneOptions:u})]})]})}),(0,e.jsx)(Fe.j,{startActions:(0,e.jsx)(Q.$,{onClick:t,variant:"tertiary",name:"cancel",children:r({id:"cancel",defaultMessage:"Cancel"})}),endActions:(0,e.jsx)(Q.$,{name:"submit",loading:n,type:"submit",children:r({id:"content-releases.modal.form.button.submit",defaultMessage:"{isCreatingRelease, select, true {Continue} other {Save}}"},{isCreatingRelease:d})})})]})})]})},Se=t=>{const a=Intl.supportedValuesOf("timeZone").map(n=>{const r=(0,g.g)(n,t);return{offset:r,value:`${r}&${n}`}}),s=a.find(n=>n.value.split("&")[1]===Intl.DateTimeFormat().resolvedOptions().timeZone);return{timezoneList:a,systemTimezone:s}},Et=({timezoneOptions:t})=>{const{values:a,errors:s,setFieldValue:n}=(0,ue.j7)(),{formatMessage:r}=(0,U.A)(),[l,d]=B.useState(t);return B.useEffect(()=>{if(a.date){const{timezoneList:u}=Se(new Date(a.date));d(u);const f=a.timezone&&u.find(p=>p.value.split("&")[1]===a.timezone.split("&")[1]);f&&n("timezone",f.value)}},[n,a.date,a.timezone]),(0,e.jsx)(Ze.G3,{label:r({id:"content-releases.modal.form.input.label.timezone",defaultMessage:"Timezone"}),autocomplete:{type:"list",filter:"contains"},name:"timezone",value:a.timezone||void 0,textValue:a.timezone?a.timezone.replace(/&/," "):void 0,onChange:u=>{n("timezone",u)},onTextValueChange:u=>{n("timezone",u)},onClear:()=>{n("timezone","")},error:s.timezone,required:!0,children:l.map(u=>(0,e.jsx)(Ge.j,{value:u.value,children:u.value.replace(/&/," ")},u.value))})},Yt=(0,H.Ay)(me.N)`
  display: block;
`,Lt=(0,H.Ay)(o.sR)`
  display: inline-block;
  &::first-letter {
    text-transform: uppercase;
  }
`,ze=t=>{let a;switch(t){case"ready":a="success";break;case"blocked":a="warning";break;case"failed":a="danger";break;case"done":a="primary";break;case"empty":default:a="neutral"}return{textColor:`${a}600`,backgroundColor:`${a}100`,borderColor:`${a}200`}},we=({sectionTitle:t,releases:a=[],isError:s=!1})=>{const{formatMessage:n}=(0,U.A)();return s?(0,e.jsx)(o.hH,{}):a?.length===0?(0,e.jsx)(Xe.p,{content:n({id:"content-releases.page.Releases.tab.emptyEntries",defaultMessage:"No releases"},{target:t}),icon:(0,e.jsx)(st.A,{width:"10rem"})}):(0,e.jsx)(Qe.x,{gap:4,children:a.map(({id:r,name:l,scheduledAt:d,status:u})=>(0,e.jsx)(Ke.E,{col:3,s:6,xs:12,children:(0,e.jsx)(Yt,{href:`content-releases/${r}`,isExternal:!1,children:(0,e.jsxs)(j.s,{direction:"column",justifyContent:"space-between",padding:4,hasRadius:!0,background:"neutral0",shadow:"tableShadow",height:"100%",width:"100%",alignItems:"start",gap:4,children:[(0,e.jsxs)(j.s,{direction:"column",alignItems:"start",gap:1,children:[(0,e.jsx)(D.o,{as:"h3",variant:"delta",fontWeight:"bold",children:l}),(0,e.jsx)(D.o,{variant:"pi",textColor:"neutral600",children:d?(0,e.jsx)(Lt,{timestamp:new Date(d)}):n({id:"content-releases.pages.Releases.not-scheduled",defaultMessage:"Not scheduled"})})]}),(0,e.jsx)(_.E,{...ze(u),children:u})]})})},r))})},$t=(0,H.Ay)(Je.F)`
  button {
    display: none;
  }
  p + div {
    margin-left: auto;
  }
`,Ot={name:"",date:null,time:"",isScheduled:!0,scheduledAt:null,timezone:null},Pt=()=>{const t=B.useRef(null),a=(0,b.zy)(),[s,n]=B.useState(!1),r=(0,o.hN)(),{formatMessage:l}=(0,U.A)(),{push:d,replace:u}=(0,b.W6)(),{formatAPIError:f}=(0,o.wq)(),[{query:p},I]=(0,o.sq)(),c=(0,g.u)(p),[A,{isLoading:S}]=(0,g.a)(),{getFeature:x}=(0,ge.bO)(),{maximumReleases:T=3}=x("cms-content-releases"),{trackUsage:Y}=(0,o.z1)(),{isLoading:L,isSuccess:$,isError:h}=c,z=c?.currentData?.meta?.activeTab||"pending",C=["pending","done"].indexOf(z);B.useEffect(()=>{a?.state?.errors&&(r({type:"warning",title:l({id:"content-releases.pages.Releases.notification.error.title",defaultMessage:"Your request could not be processed."}),message:l({id:"content-releases.pages.Releases.notification.error.message",defaultMessage:"Please try again or open another release."})}),u({state:null}))},[l,a?.state?.errors,u,r]),B.useEffect(()=>{t.current&&t.current._handlers.setSelectedTabIndex(C)},[C]);const P=()=>{n(M=>!M)};if(L)return(0,e.jsx)(V.g,{"aria-busy":L,children:(0,e.jsx)(o.Bl,{})});const W=$&&c.currentData?.meta?.pendingReleasesCount||0,m=W>=T,R=M=>{I({...p,page:1,pageSize:c?.currentData?.meta?.pagination?.pageSize||16,filters:{releasedAt:{$notNull:M!==0}}})},v=async({name:M,scheduledAt:O,timezone:Z})=>{const F=await A({name:M,scheduledAt:O,timezone:Z});"data"in F?(r({type:"success",message:l({id:"content-releases.modal.release-created-notification-success",defaultMessage:"Release created."})}),Y("didCreateRelease"),d(`/plugins/content-releases/${F.data.data.id}`)):(0,g.i)(F.error)?r({type:"warning",message:f(F.error)}):r({type:"warning",message:l({id:"notification.error",defaultMessage:"An error occurred"})})};return(0,e.jsxs)(V.g,{"aria-busy":L,children:[(0,e.jsx)(he.Q,{title:l({id:"content-releases.pages.Releases.title",defaultMessage:"Releases"}),subtitle:l({id:"content-releases.pages.Releases.header-subtitle",defaultMessage:"Create and manage content updates"}),primaryAction:(0,e.jsx)(o.d4,{permissions:g.P.create,children:(0,e.jsx)(Q.$,{startIcon:(0,e.jsx)(nt.A,{}),onClick:P,disabled:m,children:l({id:"content-releases.header.actions.add-release",defaultMessage:"New release"})})})}),(0,e.jsx)(G.s,{children:(0,e.jsxs)(e.Fragment,{children:[m&&(0,e.jsx)($t,{marginBottom:6,action:(0,e.jsx)(me.N,{href:"https://strapi.io/pricing-cloud",isExternal:!0,children:l({id:"content-releases.pages.Releases.max-limit-reached.action",defaultMessage:"Explore plans"})}),title:l({id:"content-releases.pages.Releases.max-limit-reached.title",defaultMessage:"You have reached the {number} pending {number, plural, one {release} other {releases}} limit."},{number:T}),onClose:()=>{},closeLabel:"",children:l({id:"content-releases.pages.Releases.max-limit-reached.message",defaultMessage:"Upgrade to manage an unlimited number of releases."})}),(0,e.jsxs)(Ve.f,{label:l({id:"content-releases.pages.Releases.tab-group.label",defaultMessage:"Releases list"}),variant:"simple",initialSelectedTabIndex:C,onTabChange:R,ref:t,children:[(0,e.jsxs)(J.a,{paddingBottom:8,children:[(0,e.jsxs)(ee.t,{children:[(0,e.jsx)(ee.o,{children:l({id:"content-releases.pages.Releases.tab.pending",defaultMessage:"Pending ({count})"},{count:W})}),(0,e.jsx)(ee.o,{children:l({id:"content-releases.pages.Releases.tab.done",defaultMessage:"Done"})})]}),(0,e.jsx)(ke.c,{})]}),(0,e.jsxs)(te.T,{children:[(0,e.jsx)(te.K,{children:(0,e.jsx)(we,{sectionTitle:"pending",releases:c?.currentData?.data,isError:h})}),(0,e.jsx)(te.K,{children:(0,e.jsx)(we,{sectionTitle:"done",releases:c?.currentData?.data,isError:h})})]})]}),c.currentData?.meta?.pagination?.total?(0,e.jsxs)(j.s,{paddingTop:4,alignItems:"flex-end",justifyContent:"space-between",children:[(0,e.jsx)(o._u,{options:["8","16","32","64"],defaultValue:c?.currentData?.meta?.pagination?.pageSize.toString()}),(0,e.jsx)(o.W7,{pagination:{pageCount:c?.currentData?.meta?.pagination?.pageCount||0}})]}):null]})}),s&&(0,e.jsx)(Ne,{handleClose:P,handleSubmit:v,isLoading:S,initialValues:Ot})]})},Bt=(0,H.Ay)(j.s)`
  align-self: stretch;
  border-bottom-right-radius: ${({theme:t})=>t.borderRadius};
  border-bottom-left-radius: ${({theme:t})=>t.borderRadius};
  border-top: 1px solid ${({theme:t})=>t.colors.neutral150};
`,Ee=(0,H.Ay)(k.q7)`
  svg path {
    fill: ${({theme:t,disabled:a})=>a&&t.colors.neutral500};
  }
  span {
    color: ${({theme:t,disabled:a})=>a&&t.colors.neutral500};
  }

  &:hover {
    background: ${({theme:t,variant:a="neutral"})=>t.colors[`${a}100`]};
  }
`,Ut=(0,H.Ay)(rt.A)`
  width: ${({theme:t})=>t.spaces[3]};
  height: ${({theme:t})=>t.spaces[3]};
  path {
    fill: ${({theme:t})=>t.colors.neutral600};
  }
`,Ht=(0,H.Ay)(lt.A)`
  width: ${({theme:t})=>t.spaces[3]};
  height: ${({theme:t})=>t.spaces[3]};
  path {
    fill: ${({theme:t})=>t.colors.danger600};
  }
`,Wt=(0,H.Ay)(D.o)`
  max-width: 300px;
`,Ft=({action:t,schema:a,components:s,entry:n})=>{const{formatMessage:r}=(0,U.A)(),{validate:l}=(0,ge.CQ)(),{errors:d}=l(n,{contentType:a,components:s,isCreatingEntry:!1});if(Object.keys(d).length>0){const u=Object.entries(d).map(([f,p])=>r({id:`${p.id}.withField`,defaultMessage:p.defaultMessage},{field:f})).join(" ");return(0,e.jsxs)(j.s,{gap:2,children:[(0,e.jsx)(ae.I,{color:"danger600",as:it.A}),(0,e.jsx)(qe.m,{description:u,children:(0,e.jsx)(Wt,{textColor:"danger600",variant:"omega",fontWeight:"semiBold",ellipsis:!0,children:u})})]})}return t=="publish"?(0,e.jsxs)(j.s,{gap:2,children:[(0,e.jsx)(ae.I,{color:"success600",as:pe.A}),n.publishedAt?(0,e.jsx)(D.o,{textColor:"success600",fontWeight:"bold",children:r({id:"content-releases.pages.ReleaseDetails.entry-validation.already-published",defaultMessage:"Already published"})}):(0,e.jsx)(D.o,{children:r({id:"content-releases.pages.ReleaseDetails.entry-validation.ready-to-publish",defaultMessage:"Ready to publish"})})]}):(0,e.jsxs)(j.s,{gap:2,children:[(0,e.jsx)(ae.I,{color:"success600",as:pe.A}),n.publishedAt?(0,e.jsx)(D.o,{children:r({id:"content-releases.pages.ReleaseDetails.entry-validation.ready-to-unpublish",defaultMessage:"Ready to unpublish"})}):(0,e.jsx)(D.o,{textColor:"success600",fontWeight:"bold",children:r({id:"content-releases.pages.ReleaseDetails.entry-validation.already-unpublished",defaultMessage:"Already unpublished"})})]})},Ye=({toggleEditReleaseModal:t,toggleWarningSubmit:a,children:s})=>{const{formatMessage:n,formatDate:r,formatTime:l}=(0,U.A)(),{releaseId:d}=(0,b.g)(),{data:u,isLoading:f,isError:p,error:I}=(0,g.b)({id:d}),[c,{isLoading:A}]=(0,g.e)(),S=(0,o.hN)(),{formatAPIError:x}=(0,o.wq)(),{allowedActions:{canUpdate:T,canDelete:Y}}=(0,o.ec)(g.P),L=(0,g.f)(),{trackUsage:$}=(0,o.z1)(),h=u?.data,z=async()=>{const O=await c({id:d});if("data"in O){S({type:"success",message:n({id:"content-releases.pages.ReleaseDetails.publish-notification-success",defaultMessage:"Release was published successfully."})});const{totalEntries:Z,totalPublishedEntries:F,totalUnpublishedEntries:K}=O.data.meta;$("didPublishRelease",{totalEntries:Z,totalPublishedEntries:F,totalUnpublishedEntries:K})}else(0,g.i)(O.error)?S({type:"warning",message:x(O.error)}):S({type:"warning",message:n({id:"notification.error",defaultMessage:"An error occurred"})})},C=()=>{L(g.r.util.invalidateTags([{type:"ReleaseAction",id:"LIST"},{type:"Release",id:d}]))},P=()=>h?.createdBy?h.createdBy.username?h.createdBy.username:h.createdBy.firstname?`${h.createdBy.firstname} ${h.createdBy.lastname||""}`.trim():h.createdBy.email:null;if(f)return(0,e.jsx)(V.g,{"aria-busy":f,children:(0,e.jsx)(o.Bl,{})});if(p||!h)return(0,e.jsx)(b.rd,{to:{pathname:"/plugins/content-releases",state:{errors:[{code:I?.code}]}}});const W=h.actions.meta.count||0,m=Boolean(P()),R=h.scheduledAt&&h.timezone,v=n({id:"content-releases.pages.Details.header-subtitle",defaultMessage:"{number, plural, =0 {No entries} one {# entry} other {# entries}}"},{number:W}),M=R?n({id:"content-releases.pages.ReleaseDetails.header-subtitle.scheduled",defaultMessage:"Scheduled for {date} at {time} ({offset})"},{date:r(new Date(h.scheduledAt),{weekday:"long",day:"numeric",month:"long",year:"numeric",timeZone:h.timezone}),time:l(new Date(h.scheduledAt),{timeZone:h.timezone,hourCycle:"h23"}),offset:(0,g.g)(h.timezone,new Date(h.scheduledAt))}):"";return(0,e.jsxs)(V.g,{"aria-busy":f,children:[(0,e.jsx)(he.Q,{title:h.name,subtitle:(0,e.jsxs)(j.s,{gap:2,lineHeight:6,children:[(0,e.jsx)(D.o,{textColor:"neutral600",variant:"epsilon",children:v+(R?` - ${M}`:"")}),(0,e.jsx)(_.E,{...ze(h.status),children:h.status})]}),navigationAction:(0,e.jsx)(_e.N,{startIcon:(0,e.jsx)(ot.A,{}),to:"/plugins/content-releases",children:n({id:"global.back",defaultMessage:"Back"})}),primaryAction:!h.releasedAt&&(0,e.jsxs)(j.s,{gap:2,children:[(0,e.jsxs)(k.bL,{children:[(0,e.jsx)(k.l9,{as:et.K,paddingLeft:2,paddingRight:2,"aria-label":n({id:"content-releases.header.actions.open-release-actions",defaultMessage:"Release edit and delete menu"}),icon:(0,e.jsx)(dt.A,{}),variant:"tertiary"}),(0,e.jsxs)(k.UC,{top:1,popoverPlacement:"bottom-end",children:[(0,e.jsxs)(j.s,{alignItems:"center",justifyContent:"center",direction:"column",padding:1,width:"100%",children:[(0,e.jsx)(Ee,{disabled:!T,onSelect:t,children:(0,e.jsxs)(j.s,{alignItems:"center",gap:2,hasRadius:!0,width:"100%",children:[(0,e.jsx)(Ut,{}),(0,e.jsx)(D.o,{ellipsis:!0,children:n({id:"content-releases.header.actions.edit",defaultMessage:"Edit"})})]})}),(0,e.jsx)(Ee,{disabled:!Y,onSelect:a,variant:"danger",children:(0,e.jsxs)(j.s,{alignItems:"center",gap:2,hasRadius:!0,width:"100%",children:[(0,e.jsx)(Ht,{}),(0,e.jsx)(D.o,{ellipsis:!0,textColor:"danger600",children:n({id:"content-releases.header.actions.delete",defaultMessage:"Delete"})})]})})]}),(0,e.jsxs)(Bt,{direction:"column",justifyContent:"center",alignItems:"flex-start",gap:1,padding:5,children:[(0,e.jsx)(D.o,{variant:"pi",fontWeight:"bold",children:n({id:"content-releases.header.actions.created",defaultMessage:"Created"})}),(0,e.jsxs)(D.o,{variant:"pi",color:"neutral300",children:[(0,e.jsx)(o.sR,{timestamp:new Date(h.createdAt)}),n({id:"content-releases.header.actions.created.description",defaultMessage:"{hasCreatedByUser, select, true { by {createdBy}} other { by deleted user}}"},{createdBy:P(),hasCreatedByUser:m})]})]})]})]}),(0,e.jsx)(Q.$,{size:"S",variant:"tertiary",onClick:C,children:n({id:"content-releases.header.actions.refresh",defaultMessage:"Refresh"})}),(0,e.jsx)(o.d4,{permissions:g.P.publish,children:(0,e.jsx)(Q.$,{size:"S",variant:"default",onClick:z,loading:A,disabled:h.actions.meta.count===0,children:n({id:"content-releases.header.actions.publish",defaultMessage:"Publish"})})})]})}),s]})},Zt=["contentType","locale","action"],Le=t=>t==="locale"?{id:"content-releases.pages.ReleaseDetails.groupBy.option.locales",defaultMessage:"Locales"}:t==="action"?{id:"content-releases.pages.ReleaseDetails.groupBy.option.actions",defaultMessage:"Actions"}:{id:"content-releases.pages.ReleaseDetails.groupBy.option.content-type",defaultMessage:"Content-Types"},Gt=()=>{const{formatMessage:t}=(0,U.A)(),{releaseId:a}=(0,b.g)(),[{query:s},n]=(0,o.sq)(),r=(0,o.hN)(),{formatAPIError:l}=(0,o.wq)(),{data:d,isLoading:u,isError:f,error:p}=(0,g.b)({id:a}),{allowedActions:{canUpdate:I}}=(0,o.ec)(g.P),c=d?.data,A=s?.groupBy||"contentType",{isLoading:S,isFetching:x,isError:T,data:Y,error:L}=(0,g.h)({...s,releaseId:a}),[$]=(0,g.j)(),h=async(m,R,v)=>{const M=await $({params:{releaseId:a,actionId:R},body:{type:m.target.value},query:s,actionPath:v});"error"in M&&((0,g.i)(M.error)?r({type:"warning",message:l(M.error)}):r({type:"warning",message:t({id:"notification.error",defaultMessage:"An error occurred"})}))};if(S||u)return(0,e.jsx)(G.s,{children:(0,e.jsx)(o.Bl,{})});const z=Y?.data,C=Y?.meta,P=C?.contentTypes||{},W=C?.components||{};if(f||!c){const m=[];return p&&m.push({code:p.code}),L&&m.push({code:L.code}),(0,e.jsx)(b.rd,{to:{pathname:"/plugins/content-releases",state:{errors:m}}})}return T||!z?(0,e.jsx)(G.s,{children:(0,e.jsx)(o.hH,{})}):Object.keys(z).length===0?(0,e.jsx)(G.s,{children:(0,e.jsx)(o.R1,{content:{id:"content-releases.pages.Details.tab.emptyEntries",defaultMessage:"This release is empty. Open the Content Manager, select an entry and add it to the release."},action:(0,e.jsx)(at.z,{as:q.N_,to:{pathname:"/content-manager"},style:{textDecoration:"none"},variant:"secondary",children:t({id:"content-releases.page.Details.button.openContentManager",defaultMessage:"Open the Content Manager"})})})}):(0,e.jsx)(G.s,{children:(0,e.jsxs)(j.s,{gap:8,direction:"column",alignItems:"stretch",children:[(0,e.jsx)(j.s,{children:(0,e.jsx)(fe.Z,{"aria-label":t({id:"content-releases.pages.ReleaseDetails.groupBy.aria-label",defaultMessage:"Group by"}),customizeContent:m=>t({id:"content-releases.pages.ReleaseDetails.groupBy.label",defaultMessage:"Group by {groupBy}"},{groupBy:m}),value:t(Le(A)),onChange:m=>n({groupBy:m}),children:Zt.map(m=>(0,e.jsx)(fe.eY,{value:m,children:t(Le(m))},m))})}),Object.keys(z).map(m=>(0,e.jsxs)(j.s,{gap:4,direction:"column",alignItems:"stretch",children:[(0,e.jsx)(j.s,{role:"separator","aria-label":m,children:(0,e.jsx)(_.E,{children:m})}),(0,e.jsx)(o.XI.Root,{rows:z[m].map(R=>({...R,id:Number(R.entry.id)})),colCount:z[m].length,isLoading:S,isFetching:x,children:(0,e.jsxs)(o.XI.Content,{children:[(0,e.jsxs)(o.XI.Head,{children:[(0,e.jsx)(o.XI.HeaderCell,{fieldSchemaType:"string",label:t({id:"content-releases.page.ReleaseDetails.table.header.label.name",defaultMessage:"name"}),name:"name"}),(0,e.jsx)(o.XI.HeaderCell,{fieldSchemaType:"string",label:t({id:"content-releases.page.ReleaseDetails.table.header.label.locale",defaultMessage:"locale"}),name:"locale"}),(0,e.jsx)(o.XI.HeaderCell,{fieldSchemaType:"string",label:t({id:"content-releases.page.ReleaseDetails.table.header.label.content-type",defaultMessage:"content-type"}),name:"content-type"}),(0,e.jsx)(o.XI.HeaderCell,{fieldSchemaType:"string",label:t({id:"content-releases.page.ReleaseDetails.table.header.label.action",defaultMessage:"action"}),name:"action"}),!c.releasedAt&&(0,e.jsx)(o.XI.HeaderCell,{fieldSchemaType:"string",label:t({id:"content-releases.page.ReleaseDetails.table.header.label.status",defaultMessage:"status"}),name:"status"})]}),(0,e.jsx)(o.XI.LoadingBody,{}),(0,e.jsx)(o.XI.Body,{children:z[m].map(({id:R,contentType:v,locale:M,type:O,entry:Z},F)=>(0,e.jsxs)(tt.Tr,{children:[(0,e.jsx)(X.Td,{width:"25%",maxWidth:"200px",children:(0,e.jsx)(D.o,{ellipsis:!0,children:`${v.mainFieldValue||Z.id}`})}),(0,e.jsx)(X.Td,{width:"10%",children:(0,e.jsx)(D.o,{children:`${M?.name?M.name:"-"}`})}),(0,e.jsx)(X.Td,{width:"10%",children:(0,e.jsx)(D.o,{children:v.displayName||""})}),(0,e.jsx)(X.Td,{width:"20%",children:c.releasedAt?(0,e.jsx)(D.o,{children:t({id:"content-releases.page.ReleaseDetails.table.action-published",defaultMessage:"This entry was <b>{isPublish, select, true {published} other {unpublished}}</b>."},{isPublish:O==="publish",b:K=>(0,e.jsx)(D.o,{fontWeight:"bold",children:K})})}):(0,e.jsx)(g.R,{selected:O,handleChange:K=>h(K,R,[m,F]),name:`release-action-${R}-type`,disabled:!I})}),!c.releasedAt&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(X.Td,{width:"20%",minWidth:"200px",children:(0,e.jsx)(Ft,{action:O,schema:P?.[v.uid],components:W,entry:Z})}),(0,e.jsx)(X.Td,{children:(0,e.jsx)(j.s,{justifyContent:"flex-end",children:(0,e.jsxs)(g.k.Root,{children:[(0,e.jsx)(g.k.ReleaseActionEntryLinkItem,{contentTypeUid:v.uid,entryId:Z.id,locale:M?.code}),(0,e.jsx)(g.k.DeleteReleaseActionItem,{releaseId:c.id,actionId:R})]})})})]})]},R))})]})})]},`releases-group-${m}`)),(0,e.jsxs)(j.s,{paddingTop:4,alignItems:"flex-end",justifyContent:"space-between",children:[(0,e.jsx)(o._u,{defaultValue:C?.pagination?.pageSize.toString()}),(0,e.jsx)(o.W7,{pagination:{pageCount:C?.pagination?.pageCount||0}})]})]})})},Xt=()=>{const{formatMessage:t}=(0,U.A)(),{releaseId:a}=(0,b.g)(),s=(0,o.hN)(),{formatAPIError:n}=(0,o.wq)(),{replace:r}=(0,b.W6)(),[l,d]=B.useState(!1),[u,f]=B.useState(!1),{isLoading:p,data:I,isSuccess:c}=(0,g.b)({id:a}),[A,{isLoading:S}]=(0,g.c)(),[x,{isLoading:T}]=(0,g.d)(),Y=()=>{d(v=>!v)},L=()=>f(v=>!v);if(p)return(0,e.jsx)(Ye,{toggleEditReleaseModal:Y,toggleWarningSubmit:L,children:(0,e.jsx)(G.s,{children:(0,e.jsx)(o.Bl,{})})});const $=c&&I?.data||null,h=$?.name||"",z=$?.timezone??null,C=$?.scheduledAt&&z?Re($.scheduledAt,z):null,P=C?(0,xe.A)(C,"yyyy-MM-dd"):null,W=C?(0,xe.A)(C,"HH:mm"):"",m=async v=>{const M=await A({id:a,name:v.name,scheduledAt:v.scheduledAt,timezone:v.timezone});"data"in M?(s({type:"success",message:t({id:"content-releases.modal.release-updated-notification-success",defaultMessage:"Release updated."})}),Y()):(0,g.i)(M.error)?s({type:"warning",message:n(M.error)}):s({type:"warning",message:t({id:"notification.error",defaultMessage:"An error occurred"})})},R=async()=>{const v=await x({id:a});"data"in v?r("/plugins/content-releases"):(0,g.i)(v.error)?s({type:"warning",message:n(v.error)}):s({type:"warning",message:t({id:"notification.error",defaultMessage:"An error occurred"})})};return(0,e.jsxs)(Ye,{toggleEditReleaseModal:Y,toggleWarningSubmit:L,children:[(0,e.jsx)(Gt,{}),l&&(0,e.jsx)(Ne,{handleClose:Y,handleSubmit:m,isLoading:p||S,initialValues:{name:h||"",scheduledAt:C,date:P,time:W,isScheduled:Boolean(C),timezone:z}}),(0,e.jsx)(o.TM,{bodyText:{id:"content-releases.dialog.confirmation-message",defaultMessage:"Are you sure you want to delete this release?"},isOpen:u,isConfirmButtonLoading:T,onToggleDialog:L,onConfirm:R})]})},Qt=()=>(0,e.jsx)(o.kz,{permissions:g.P.main,children:(0,e.jsxs)(b.dO,{children:[(0,e.jsx)(b.qh,{exact:!0,path:`/plugins/${g.p}`,component:Pt}),(0,e.jsx)(b.qh,{exact:!0,path:`/plugins/${g.p}/:releaseId`,component:Xt})]})})}}]);
