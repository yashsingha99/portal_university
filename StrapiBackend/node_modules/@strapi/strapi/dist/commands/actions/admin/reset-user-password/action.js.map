{"version":3,"file":"action.js","sources":["../../../../../src/commands/actions/admin/reset-user-password/action.ts"],"sourcesContent":["import _ from 'lodash';\nimport inquirer from 'inquirer';\nimport strapi from '../../../../Strapi';\n\ninterface CmdOptions {\n  email?: string;\n  password?: string;\n}\n\ninterface Answers {\n  email: string;\n  password: string;\n  confirm: boolean;\n}\n\nconst promptQuestions: ReadonlyArray<inquirer.DistinctQuestion<Answers>> = [\n  { type: 'input', name: 'email', message: 'User email?' },\n  { type: 'password', name: 'password', message: 'New password?' },\n  {\n    type: 'confirm',\n    name: 'confirm',\n    message: \"Do you really want to reset this user's password?\",\n  },\n];\n\n/**\n * Reset user's password\n */\nexport default async (cmdOptions: CmdOptions = {}) => {\n  const { email, password } = cmdOptions;\n\n  if (_.isEmpty(email) && _.isEmpty(password) && process.stdin.isTTY) {\n    const inquiry = await inquirer.prompt(promptQuestions);\n\n    if (!inquiry.confirm) {\n      process.exit(0);\n    }\n\n    return changePassword(inquiry);\n  }\n\n  if (_.isEmpty(email) || _.isEmpty(password)) {\n    console.error('Missing required options `email` or `password`');\n    process.exit(1);\n  }\n\n  return changePassword({ email, password });\n};\n\nasync function changePassword({ email, password }: CmdOptions) {\n  const appContext = await strapi.compile();\n  const app = await strapi(appContext).load();\n\n  await app.admin.services.user.resetPasswordByEmail(email, password);\n\n  console.log(`Successfully reset user's password`);\n  process.exit(0);\n}\n"],"names":["_","inquirer","strapi"],"mappings":";;;;;;;AAeA,MAAM,kBAAqE;AAAA,EACzE,EAAE,MAAM,SAAS,MAAM,SAAS,SAAS,cAAc;AAAA,EACvD,EAAE,MAAM,YAAY,MAAM,YAAY,SAAS,gBAAgB;AAAA,EAC/D;AAAA,IACE,MAAM;AAAA,IACN,MAAM;AAAA,IACN,SAAS;AAAA,EACX;AACF;AAKA,MAAA,SAAe,OAAO,aAAyB,CAAA,MAAO;AAC9C,QAAA,EAAE,OAAO,SAAa,IAAA;AAExB,MAAAA,mBAAE,QAAQ,KAAK,KAAKA,WAAA,QAAE,QAAQ,QAAQ,KAAK,QAAQ,MAAM,OAAO;AAClE,UAAM,UAAU,MAAMC,kBAAAA,QAAS,OAAO,eAAe;AAEjD,QAAA,CAAC,QAAQ,SAAS;AACpB,cAAQ,KAAK,CAAC;AAAA,IAChB;AAEA,WAAO,eAAe,OAAO;AAAA,EAC/B;AAEA,MAAID,WAAAA,QAAE,QAAQ,KAAK,KAAKA,WAAAA,QAAE,QAAQ,QAAQ,GAAG;AAC3C,YAAQ,MAAM,gDAAgD;AAC9D,YAAQ,KAAK,CAAC;AAAA,EAChB;AAEA,SAAO,eAAe,EAAE,OAAO,SAAU,CAAA;AAC3C;AAEA,eAAe,eAAe,EAAE,OAAO,YAAwB;AACvD,QAAA,aAAa,MAAME,OAAO;AAChC,QAAM,MAAM,MAAMA,OAAO,UAAU,EAAE,KAAK;AAE1C,QAAM,IAAI,MAAM,SAAS,KAAK,qBAAqB,OAAO,QAAQ;AAElE,UAAQ,IAAI,oCAAoC;AAChD,UAAQ,KAAK,CAAC;AAChB;;"}