{"version":3,"file":"fetch.mjs","sources":["../../src/utils/fetch.ts"],"sourcesContent":["import nodeFetch, { RequestInit, Response } from 'node-fetch';\nimport { HttpsProxyAgent, HttpsProxyAgentOptions } from 'https-proxy-agent';\n\nimport type { Strapi } from '@strapi/types';\n\nexport interface Fetch {\n  (url: string, options: RequestInit): Promise<Response>;\n  agent?: HttpsProxyAgent;\n}\n\nexport function createStrapiFetch(strapi: Strapi): Fetch {\n  function fetch(url: string, options: RequestInit) {\n    return nodeFetch(url, {\n      ...(fetch.agent ? { agent: fetch.agent } : {}),\n      ...options,\n    });\n  }\n\n  const { globalProxy: proxy } = strapi.config.get<{\n    globalProxy: HttpsProxyAgentOptions;\n  }>('server');\n\n  if (proxy) {\n    fetch.agent = new HttpsProxyAgent(proxy);\n  }\n\n  return fetch;\n}\n"],"names":[],"mappings":";;AAUO,SAAS,kBAAkB,QAAuB;AAC9C,WAAA,MAAM,KAAa,SAAsB;AAChD,WAAO,UAAU,KAAK;AAAA,MACpB,GAAI,MAAM,QAAQ,EAAE,OAAO,MAAM,MAAA,IAAU,CAAC;AAAA,MAC5C,GAAG;AAAA,IAAA,CACJ;AAAA,EACH;AAEA,QAAM,EAAE,aAAa,UAAU,OAAO,OAAO,IAE1C,QAAQ;AAEX,MAAI,OAAO;AACH,UAAA,QAAQ,IAAI,gBAAgB,KAAK;AAAA,EACzC;AAEO,SAAA;AACT;"}