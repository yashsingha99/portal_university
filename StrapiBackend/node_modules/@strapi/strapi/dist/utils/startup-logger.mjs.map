{"version":3,"file":"startup-logger.mjs","sources":["../../src/utils/startup-logger.ts"],"sourcesContent":["import chalk from 'chalk';\nimport CLITable from 'cli-table3';\nimport _ from 'lodash/fp';\nimport { getAbsoluteAdminUrl, getAbsoluteServerUrl } from '@strapi/utils';\n\nimport type { Strapi } from '@strapi/types';\n\nexport default (app: Strapi) => {\n  return {\n    logStats() {\n      const columns = Math.min(process.stderr.columns, 80) - 2;\n      console.log();\n      console.log(chalk.black.bgWhite(_.padEnd(columns, ' Project information')));\n      console.log();\n\n      const infoTable = new CLITable({\n        colWidths: [20, 50],\n        chars: { mid: '', 'left-mid': '', 'mid-mid': '', 'right-mid': '' },\n      });\n\n      infoTable.push(\n        [chalk.blue('Time'), `${new Date()}`],\n        [chalk.blue('Launched in'), `${Date.now() - app.config.launchedAt} ms`],\n        [chalk.blue('Environment'), app.config.environment],\n        [chalk.blue('Process PID'), process.pid],\n        [chalk.blue('Version'), `${app.config.info.strapi} (node ${process.version})`],\n        [chalk.blue('Edition'), app.EE ? 'Enterprise' : 'Community'],\n        [chalk.blue('Database'), app.db?.dialect.client]\n      );\n\n      console.log(infoTable.toString());\n      console.log();\n      console.log(chalk.black.bgWhite(_.padEnd(columns, ' Actions available')));\n      console.log();\n    },\n\n    logFirstStartupMessage() {\n      this.logStats();\n\n      console.log(chalk.bold('One more thing...'));\n      console.log(\n        chalk.grey('Create your first administrator üíª by going to the administration panel at:')\n      );\n      console.log();\n\n      const addressTable = new CLITable();\n\n      const adminUrl = getAbsoluteAdminUrl(strapi.config);\n      addressTable.push([chalk.bold(adminUrl)]);\n\n      console.log(`${addressTable.toString()}`);\n      console.log();\n    },\n\n    logDefaultStartupMessage() {\n      this.logStats();\n\n      console.log(chalk.bold('Welcome back!'));\n\n      if (app.config.serveAdminPanel === true) {\n        console.log(chalk.grey('To manage your project üöÄ, go to the administration panel at:'));\n        const adminUrl = getAbsoluteAdminUrl(strapi.config);\n        console.log(chalk.bold(adminUrl));\n        console.log();\n      }\n\n      console.log(chalk.grey('To access the server ‚ö°Ô∏è, go to:'));\n      const serverUrl = getAbsoluteServerUrl(strapi.config);\n      console.log(chalk.bold(serverUrl));\n      console.log();\n    },\n\n    logStartupMessage({ isInitialized }: { isInitialized: boolean }) {\n      // Should the startup message be displayed?\n      const hideStartupMessage = process.env.STRAPI_HIDE_STARTUP_MESSAGE\n        ? process.env.STRAPI_HIDE_STARTUP_MESSAGE === 'true'\n        : false;\n\n      if (hideStartupMessage === false) {\n        if (!isInitialized) {\n          this.logFirstStartupMessage();\n        } else {\n          this.logDefaultStartupMessage();\n        }\n      }\n    },\n  };\n};\n"],"names":[],"mappings":";;;;AAOA,MAAe,sBAAA,CAAC,QAAgB;AACvB,SAAA;AAAA,IACL,WAAW;AACT,YAAM,UAAU,KAAK,IAAI,QAAQ,OAAO,SAAS,EAAE,IAAI;AACvD,cAAQ,IAAI;AACJ,cAAA,IAAI,MAAM,MAAM,QAAQ,EAAE,OAAO,SAAS,sBAAsB,CAAC,CAAC;AAC1E,cAAQ,IAAI;AAEN,YAAA,YAAY,IAAI,SAAS;AAAA,QAC7B,WAAW,CAAC,IAAI,EAAE;AAAA,QAClB,OAAO,EAAE,KAAK,IAAI,YAAY,IAAI,WAAW,IAAI,aAAa,GAAG;AAAA,MAAA,CAClE;AAES,gBAAA;AAAA,QACR,CAAC,MAAM,KAAK,MAAM,GAAG,GAAG,oBAAI,KAAM,CAAA,EAAE;AAAA,QACpC,CAAC,MAAM,KAAK,aAAa,GAAG,GAAG,KAAK,IAAA,IAAQ,IAAI,OAAO,UAAU,KAAK;AAAA,QACtE,CAAC,MAAM,KAAK,aAAa,GAAG,IAAI,OAAO,WAAW;AAAA,QAClD,CAAC,MAAM,KAAK,aAAa,GAAG,QAAQ,GAAG;AAAA,QACvC,CAAC,MAAM,KAAK,SAAS,GAAG,GAAG,IAAI,OAAO,KAAK,MAAM,UAAU,QAAQ,OAAO,GAAG;AAAA,QAC7E,CAAC,MAAM,KAAK,SAAS,GAAG,IAAI,KAAK,eAAe,WAAW;AAAA,QAC3D,CAAC,MAAM,KAAK,UAAU,GAAG,IAAI,IAAI,QAAQ,MAAM;AAAA,MAAA;AAGzC,cAAA,IAAI,UAAU,SAAU,CAAA;AAChC,cAAQ,IAAI;AACJ,cAAA,IAAI,MAAM,MAAM,QAAQ,EAAE,OAAO,SAAS,oBAAoB,CAAC,CAAC;AACxE,cAAQ,IAAI;AAAA,IACd;AAAA,IAEA,yBAAyB;AACvB,WAAK,SAAS;AAEd,cAAQ,IAAI,MAAM,KAAK,mBAAmB,CAAC;AACnC,cAAA;AAAA,QACN,MAAM,KAAK,6EAA6E;AAAA,MAAA;AAE1F,cAAQ,IAAI;AAEN,YAAA,eAAe,IAAI;AAEnB,YAAA,WAAW,oBAAoB,OAAO,MAAM;AAClD,mBAAa,KAAK,CAAC,MAAM,KAAK,QAAQ,CAAC,CAAC;AAExC,cAAQ,IAAI,GAAG,aAAa,SAAA,CAAU,EAAE;AACxC,cAAQ,IAAI;AAAA,IACd;AAAA,IAEA,2BAA2B;AACzB,WAAK,SAAS;AAEd,cAAQ,IAAI,MAAM,KAAK,eAAe,CAAC;AAEnC,UAAA,IAAI,OAAO,oBAAoB,MAAM;AACvC,gBAAQ,IAAI,MAAM,KAAK,+DAA+D,CAAC;AACjF,cAAA,WAAW,oBAAoB,OAAO,MAAM;AAClD,gBAAQ,IAAI,MAAM,KAAK,QAAQ,CAAC;AAChC,gBAAQ,IAAI;AAAA,MACd;AAEA,cAAQ,IAAI,MAAM,KAAK,iCAAiC,CAAC;AACnD,YAAA,YAAY,qBAAqB,OAAO,MAAM;AACpD,cAAQ,IAAI,MAAM,KAAK,SAAS,CAAC;AACjC,cAAQ,IAAI;AAAA,IACd;AAAA,IAEA,kBAAkB,EAAE,iBAA6C;AAE/D,YAAM,qBAAqB,QAAQ,IAAI,8BACnC,QAAQ,IAAI,gCAAgC,SAC5C;AAEJ,UAAI,uBAAuB,OAAO;AAChC,YAAI,CAAC,eAAe;AAClB,eAAK,uBAAuB;AAAA,QAAA,OACvB;AACL,eAAK,yBAAyB;AAAA,QAChC;AAAA,MACF;AAAA,IACF;AAAA,EAAA;AAEJ;"}