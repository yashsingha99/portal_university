{"version":3,"file":"constants-hJoeTT6L.js","sources":["../../ee/admin/src/pages/AuthResponse.tsx","../../ee/admin/src/constants.ts"],"sourcesContent":["import * as React from 'react';\n\nimport { LoadingIndicatorPage } from '@strapi/helper-plugin';\nimport Cookies from 'js-cookie';\nimport { useIntl } from 'react-intl';\nimport { useHistory, useRouteMatch } from 'react-router-dom';\n\nimport { useAuth } from '../../../../admin/src/features/Auth';\n\nconst AuthResponse = () => {\n  const match = useRouteMatch<{ authResponse: string }>('/auth/login/:authResponse');\n  const { formatMessage } = useIntl();\n  const { push } = useHistory();\n\n  const redirectToOops = React.useCallback(() => {\n    push(\n      `/auth/oops?info=${encodeURIComponent(\n        formatMessage({\n          id: 'Auth.form.button.login.providers.error',\n          defaultMessage: 'We cannot connect you through the selected provider.',\n        })\n      )}`\n    );\n  }, [push, formatMessage]);\n\n  const setToken = useAuth('AuthResponse', (state) => state.setToken);\n\n  React.useEffect(() => {\n    if (match?.params.authResponse === 'error') {\n      redirectToOops();\n    }\n\n    if (match?.params.authResponse === 'success') {\n      const jwtToken = Cookies.get('jwtToken');\n\n      if (jwtToken) {\n        setToken(jwtToken);\n\n        Cookies.remove('jwtToken');\n\n        push('/auth/login');\n      } else {\n        redirectToOops();\n      }\n    }\n  }, [match, redirectToOops, setToken, push]);\n\n  return <LoadingIndicatorPage />;\n};\n\nexport { AuthResponse };\n","import { AuthResponse } from './pages/AuthResponse';\n\nimport type { SettingsMenu } from '../../../admin/src/constants';\nimport type { PermissionMap } from '../../../admin/src/types/permissions';\n\nexport const ADMIN_PERMISSIONS_EE = {\n  settings: {\n    auditLogs: {\n      main: [{ action: 'admin::audit-logs.read', subject: null }],\n      read: [{ action: 'admin::audit-logs.read', subject: null }],\n      update: [{ action: 'admin::audit-logs.update', subject: null }],\n    },\n    'review-workflows': {\n      main: [{ action: 'admin::review-workflows.read', subject: null }],\n      read: [{ action: 'admin::review-workflows.read', subject: null }],\n      create: [{ action: 'admin::review-workflows.create', subject: null }],\n      delete: [{ action: 'admin::review-workflows.delete', subject: null }],\n      update: [{ action: 'admin::review-workflows.update', subject: null }],\n    },\n    sso: {\n      main: [{ action: 'admin::provider-login.read', subject: null }],\n      read: [{ action: 'admin::provider-login.read', subject: null }],\n      update: [{ action: 'admin::provider-login.update', subject: null }],\n    },\n  },\n} satisfies {\n  settings: Pick<PermissionMap['settings'], 'auditLogs' | 'review-workflows' | 'sso'>;\n};\n\nexport const ROUTES_EE = [\n  {\n    Component: () => ({ default: AuthResponse }),\n    to: '/auth/login/:authResponse',\n    exact: true,\n  },\n];\n\n// TODO: the constants.js file is imported before the React application is setup and\n// therefore `window.strapi` might not exist at import-time. We should probably define\n// which constant is available at which stage of the application lifecycle.\nexport const SETTINGS_LINKS_EE = (): SettingsMenu => ({\n  global: [\n    ...(window.strapi.features.isEnabled(window.strapi.features.SSO)\n      ? [\n          {\n            intlLabel: { id: 'Settings.sso.title', defaultMessage: 'Single Sign-On' },\n            to: '/settings/single-sign-on',\n            id: 'sso',\n          },\n        ]\n      : []),\n\n    ...(window.strapi.features.isEnabled(window.strapi.features.REVIEW_WORKFLOWS)\n      ? [\n          {\n            intlLabel: {\n              id: 'Settings.review-workflows.page.title',\n              defaultMessage: 'Review Workflows',\n            },\n            to: '/settings/review-workflows',\n            id: 'review-workflows',\n          },\n        ]\n      : []),\n  ],\n\n  admin: [\n    ...(window.strapi.features.isEnabled(window.strapi.features.AUDIT_LOGS)\n      ? [\n          {\n            intlLabel: { id: 'global.auditLogs', defaultMessage: 'Audit Logs' },\n            to: '/settings/audit-logs?pageSize=50&page=1&sort=date:DESC',\n            id: 'auditLogs',\n          },\n        ]\n      : []),\n  ],\n});\n"],"names":["useRouteMatch","useIntl","useHistory","React","useAuth","Cookies","LoadingIndicatorPage"],"mappings":"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"}