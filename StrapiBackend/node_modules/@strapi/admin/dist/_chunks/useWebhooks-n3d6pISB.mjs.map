{"version":3,"file":"useWebhooks-n3d6pISB.mjs","sources":["../../admin/src/services/webhooks.ts","../../admin/src/pages/Settings/pages/Webhooks/hooks/useWebhooks.ts"],"sourcesContent":["import * as Webhooks from '../../../shared/contracts/webhooks';\n\nimport { adminApi } from './api';\n\nconst webhooksSerivce = adminApi.injectEndpoints({\n  endpoints: (builder) => ({\n    getWebhooks: builder.query<\n      Webhooks.GetWebhooks.Response['data'],\n      Webhooks.GetWebhook.Params | void\n    >({\n      query: (args) => ({\n        url: `/admin/webhooks/${args?.id ?? ''}`,\n        method: 'GET',\n      }),\n      transformResponse: (\n        response: Webhooks.GetWebhooks.Response | Webhooks.GetWebhook.Response\n      ) => {\n        if (Array.isArray(response.data)) {\n          return response.data;\n        } else {\n          return [response.data];\n        }\n      },\n      providesTags: (res, _err, arg) => {\n        if (typeof arg === 'object' && 'id' in arg) {\n          return [{ type: 'Webhook' as const, id: arg.id }];\n        } else {\n          return [\n            ...(res?.map(({ id }) => ({ type: 'Webhook' as const, id })) ?? []),\n            { type: 'Webhook' as const, id: 'LIST' },\n          ];\n        }\n      },\n    }),\n    createWebhook: builder.mutation<\n      Webhooks.CreateWebhook.Response['data'],\n      Omit<Webhooks.CreateWebhook.Request['body'], 'id' | 'isEnabled'>\n    >({\n      query: (body) => ({\n        url: `/admin/webhooks`,\n        method: 'POST',\n        data: body,\n      }),\n      transformResponse: (response: Webhooks.CreateWebhook.Response) => response.data,\n      invalidatesTags: [{ type: 'Webhook', id: 'LIST' }],\n    }),\n    updateWebhook: builder.mutation<\n      Webhooks.UpdateWebhook.Response['data'],\n      Webhooks.UpdateWebhook.Request['body'] & Webhooks.UpdateWebhook.Params\n    >({\n      query: ({ id, ...body }) => ({\n        url: `/admin/webhooks/${id}`,\n        method: 'PUT',\n        data: body,\n      }),\n      transformResponse: (response: Webhooks.UpdateWebhook.Response) => response.data,\n      invalidatesTags: (_res, _err, { id }) => [{ type: 'Webhook', id }],\n    }),\n    triggerWebhook: builder.mutation<\n      Webhooks.TriggerWebhook.Response['data'],\n      Webhooks.TriggerWebhook.Params['id']\n    >({\n      query: (webhookId) => ({\n        url: `/admin/webhooks/${webhookId}/trigger`,\n        method: 'POST',\n      }),\n      transformResponse: (response: Webhooks.TriggerWebhook.Response) => response.data,\n    }),\n    deleteManyWebhooks: builder.mutation<\n      Webhooks.DeleteWebhooks.Response['data'],\n      Webhooks.DeleteWebhooks.Request['body']\n    >({\n      query: (body) => ({\n        url: `/admin/webhooks/batch-delete`,\n        method: 'POST',\n        data: body,\n      }),\n      transformResponse: (response: Webhooks.DeleteWebhooks.Response) => response.data,\n      invalidatesTags: (_res, _err, { ids }) => ids.map((id) => ({ type: 'Webhook', id })),\n    }),\n  }),\n  overrideExisting: false,\n});\n\nconst {\n  useGetWebhooksQuery,\n  useCreateWebhookMutation,\n  useUpdateWebhookMutation,\n  useTriggerWebhookMutation,\n  useDeleteManyWebhooksMutation,\n} = webhooksSerivce;\n\nexport {\n  useGetWebhooksQuery,\n  useCreateWebhookMutation,\n  useUpdateWebhookMutation,\n  useTriggerWebhookMutation,\n  useDeleteManyWebhooksMutation,\n};\n","import { SerializedError } from '@reduxjs/toolkit';\n\nimport { GetWebhook, GetWebhooks } from '../../../../../../../shared/contracts/webhooks';\nimport {\n  useGetWebhooksQuery,\n  useCreateWebhookMutation,\n  useUpdateWebhookMutation,\n  useTriggerWebhookMutation,\n  useDeleteManyWebhooksMutation,\n} from '../../../../../services/webhooks';\nimport { BaseQueryError } from '../../../../../utils/baseQuery';\n\nconst useWebhooks = (\n  args: GetWebhook.Params | void = undefined,\n  queryArgs?: Parameters<typeof useGetWebhooksQuery>[1]\n) => {\n  const { data: webhooks, isLoading, error } = useGetWebhooksQuery(args, queryArgs);\n  const [createWebhook] = useCreateWebhookMutation();\n  const [updateWebhook] = useUpdateWebhookMutation();\n  const [triggerWebhook] = useTriggerWebhookMutation();\n  const [deleteManyWebhooks] = useDeleteManyWebhooksMutation();\n\n  return {\n    webhooks: webhooks as GetWebhooks.Response['data'] | undefined,\n    isLoading: isLoading as boolean,\n    error: error as BaseQueryError | SerializedError,\n    createWebhook,\n    updateWebhook,\n    triggerWebhook,\n    deleteManyWebhooks,\n  };\n};\n\nexport { useWebhooks };\n"],"names":[],"mappings":";AAIA,MAAM,kBAAkB,SAAS,gBAAgB;AAAA,EAC/C,WAAW,CAAC,aAAa;AAAA,IACvB,aAAa,QAAQ,MAGnB;AAAA,MACA,OAAO,CAAC,UAAU;AAAA,QAChB,KAAK,mBAAmB,MAAM,MAAM,EAAE;AAAA,QACtC,QAAQ;AAAA,MAAA;AAAA,MAEV,mBAAmB,CACjB,aACG;AACH,YAAI,MAAM,QAAQ,SAAS,IAAI,GAAG;AAChC,iBAAO,SAAS;AAAA,QAAA,OACX;AACE,iBAAA,CAAC,SAAS,IAAI;AAAA,QACvB;AAAA,MACF;AAAA,MACA,cAAc,CAAC,KAAK,MAAM,QAAQ;AAChC,YAAI,OAAO,QAAQ,YAAY,QAAQ,KAAK;AAC1C,iBAAO,CAAC,EAAE,MAAM,WAAoB,IAAI,IAAI,IAAI;AAAA,QAAA,OAC3C;AACE,iBAAA;AAAA,YACL,GAAI,KAAK,IAAI,CAAC,EAAE,GAAU,OAAA,EAAE,MAAM,WAAoB,KAAK,KAAK,CAAC;AAAA,YACjE,EAAE,MAAM,WAAoB,IAAI,OAAO;AAAA,UAAA;AAAA,QAE3C;AAAA,MACF;AAAA,IAAA,CACD;AAAA,IACD,eAAe,QAAQ,SAGrB;AAAA,MACA,OAAO,CAAC,UAAU;AAAA,QAChB,KAAK;AAAA,QACL,QAAQ;AAAA,QACR,MAAM;AAAA,MAAA;AAAA,MAER,mBAAmB,CAAC,aAA8C,SAAS;AAAA,MAC3E,iBAAiB,CAAC,EAAE,MAAM,WAAW,IAAI,QAAQ;AAAA,IAAA,CAClD;AAAA,IACD,eAAe,QAAQ,SAGrB;AAAA,MACA,OAAO,CAAC,EAAE,IAAI,GAAG,YAAY;AAAA,QAC3B,KAAK,mBAAmB,EAAE;AAAA,QAC1B,QAAQ;AAAA,QACR,MAAM;AAAA,MAAA;AAAA,MAER,mBAAmB,CAAC,aAA8C,SAAS;AAAA,MAC3E,iBAAiB,CAAC,MAAM,MAAM,EAAE,SAAS,CAAC,EAAE,MAAM,WAAW,IAAI;AAAA,IAAA,CAClE;AAAA,IACD,gBAAgB,QAAQ,SAGtB;AAAA,MACA,OAAO,CAAC,eAAe;AAAA,QACrB,KAAK,mBAAmB,SAAS;AAAA,QACjC,QAAQ;AAAA,MAAA;AAAA,MAEV,mBAAmB,CAAC,aAA+C,SAAS;AAAA,IAAA,CAC7E;AAAA,IACD,oBAAoB,QAAQ,SAG1B;AAAA,MACA,OAAO,CAAC,UAAU;AAAA,QAChB,KAAK;AAAA,QACL,QAAQ;AAAA,QACR,MAAM;AAAA,MAAA;AAAA,MAER,mBAAmB,CAAC,aAA+C,SAAS;AAAA,MAC5E,iBAAiB,CAAC,MAAM,MAAM,EAAE,IAAI,MAAM,IAAI,IAAI,CAAC,QAAQ,EAAE,MAAM,WAAW,GAAK,EAAA;AAAA,IAAA,CACpF;AAAA,EAAA;AAAA,EAEH,kBAAkB;AACpB,CAAC;AAED,MAAM;AAAA,EACJ;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF,IAAI;AC9EJ,MAAM,cAAc,CAClB,OAAiC,QACjC,cACG;AACG,QAAA,EAAE,MAAM,UAAU,WAAW,UAAU,oBAAoB,MAAM,SAAS;AAC1E,QAAA,CAAC,aAAa,IAAI;AAClB,QAAA,CAAC,aAAa,IAAI;AAClB,QAAA,CAAC,cAAc,IAAI;AACnB,QAAA,CAAC,kBAAkB,IAAI;AAEtB,SAAA;AAAA,IACL;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,EAAA;AAEJ;"}